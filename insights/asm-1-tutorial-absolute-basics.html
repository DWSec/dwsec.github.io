<!DOCTYPE html><!-- Last Published: Fri Jan 12 2024 08:39:01 GMT+0000 (Coordinated Universal Time) --><html data-wf-page="6572f99ba87060097855250a" data-wf-site="63b6d5e577ebd8b19dbf7bfe" data-wf-collection="6572f99ba87060097855251a" data-wf-item-slug="asm-1-tutorial-absolute-basics"><head><meta charset="utf-8"/><title>Dark Waves Infosec Ltd</title><meta content="width=device-width, initial-scale=1" name="viewport"/><link href="../css/dwsec.webflow.1049a7f6a.min.css" rel="stylesheet" type="text/css"/><script type="text/javascript">!function(o,c){var n=c.documentElement,t=" w-mod-";n.className+=t+"js",("ontouchstart"in o||o.DocumentTouch&&c instanceof DocumentTouch)&&(n.className+=t+"touch")}(window,document);</script><link href="../images/favicon.png" rel="shortcut icon" type="image/x-icon"/><link href="../images/app-icon.png" rel="apple-touch-icon"/></head><body><div data-animation="default" data-collapse="medium" data-duration="400" data-easing="ease" data-easing2="ease" role="banner" class="navbar w-nav"><div class="container navbar-container"><a href="/" class="home-link w-inline-block"><img src="../images/02-white-isologotype-403x.png" loading="lazy" width="150" sizes="(max-width: 479px) 90px, (max-width: 767px) 120px, 150px" alt="" srcset="../images/02-white-isologotype-403x-p-500.png 500w, ../images/02-white-isologotype-403x-1.png 901w" class="logo"/></a><div class="menu-button w-nav-button"><div class="w-icon-nav-menu"></div></div><nav role="navigation" class="nav-menu w-nav-menu"><div class="navbar-menu-items"><a href="/about-us" class="nav-link w-inline-block"><div>About us</div><div class="nav-link-line"></div></a><a href="/services" class="nav-link w-inline-block"><div>Services</div><div class="nav-link-line"></div></a><a href="/insights" class="nav-link w-inline-block"><div>Insights</div><div class="nav-link-line"></div></a><a href="#" class="button navbar-button w-button">Contact us</a></div></nav></div></div><div class="section insight-template"><div class="scroll-indicator scroll_indicator"></div><div class="container centered"><div class="insight-header-image-contain"><div class="insight-title-wrap"><h2 class="insight-title">ASM 1 Tutorial: Absolute Basics</h2><div class="insight-date">July 14, 2020</div></div><div style="background-image:url(&quot;../images/img0.webp&quot;)" class="insight-header-image"></div></div><div class="insight-post-contain"><div class="inisght-rich-text-block w-richtext"><p>In this series we’ll be working through these tutorials on the basics of assembly. We’ll be using the Netwide Assembler (NASM) (<a href="https://www.nasm.us/">https://www.nasm.us/</a>) to write assembly programs on a 32-bit i686 Ubuntu Linux virtual machine.</p><p>The goal of this series is to document my journey as I learn how to program in assembly. I’m eager to improve my command over assembly language because I want to learn more about exploit development and low-level programming. Therefore, there may be asides or references to matters related to cyber-security / exploitation throughout the series.</p><p>Finally, this series is not completely original and is based directly off the tutorial created by <a href="https://asmtutor.com/#lesson1">https://asmtutor.com/</a>. Most of the assembly code examples are pulled from that tutorial series.</p><p>Now, let’s jump in.</p><p>Every assembly program gets broken into three main sections:</p><ol role="list"><li>.data section</li><li>.bss section</li><li>.text section</li></ol><p>The data section is used for “declaring initialized data and constants. The data does not change at runtime,” (tutorialspoint.com). This is significant because the amount of space allocated in the data section cannot be increased at runtime.</p><p>The bss section is used for declaring variables.</p><p>The text section is where the actual instructions for the program go. This section must begin with the instruction “global _start which tells the kernel where program execution begins,” (tutorialspoint.com).</p><p>The only interface the programmer has above the actual hardware is the kernel. In order to build useful programs in assembly we have to use the “Linux system calls provided by the kernel,” (asmtutor.com). System calls are implemented as assembly language instructions and are “usually made when a process in user mode requires access to a resource,” (tutorialspoint.com). When you execute a system call a few things happen:</p><ol role="list"><li>The user application sets up arguments for system call. Depending on the system call, this likely means loading up general purpose registers.</li><li>Once the arguments are staged an interrupt instruction “INT” is run which indicates that the user program needs a resource from the OS.</li><li>The interrupt instruction has a number which tells the kernel what the user program needs. On Linux, 0x80 is the interrupt number that says the user needs to make a system call: “INT 0x80.”</li><li>The system call number has been loaded into the EAX register. This way, when the interrupt is triggered, the kernel knows what system call in the system call table the user is trying to execute. For example, “requesting an interrupt when EAX = 1 will call sys_exit and requesting and interrupt when EAX = 4 will call sys_write(),” (asmtutor.com).</li><li>Control jumps to the instructions at the address specified at in the system call table. The user program state is preserved, the system call executes, and control is transferred back to the user program.</li></ol><p>‍</p><figure class="w-richtext-align-center w-richtext-figure-type-image"><div><img src="../images/img1-20.webp" loading="lazy" alt=""/></div></figure><p>‍</p><p>Here’s a visual explanation of the system call process:</p><p>‍</p><figure class="w-richtext-align-center w-richtext-figure-type-image"><div><img src="../images/img2-1.webp" loading="lazy" alt=""/></div></figure><p>‍</p><p>“””</p><p>There are four general classes of system calls (tutorialspoint.com):</p><ol role="list"><li>Process control: deal with process creation, termination, etc</li><li>File management: creating, deleting, reading, writing, etc</li><li>Device management: reading from device buffers into other device buffers</li><li>Information maintenance: information transfer between user program and operating system</li></ol><p>“””</p><p>Building on this, there are a few common scenarios that require system calls (asmtutor.com):</p><p>“””</p><ol role="list"><li>Files system requires the creation or deletion of files. Reading or writing from files also requires a system call.</li><li>Creation and management of new processes.</li><li>Network connections also require system calls. This includes sending and receiving of packets.</li><li>Access to hardware devices like printers and scanners.</li></ol><p>“””</p><p>Now that we have a better understanding about what system calls are and how they’re implemented, let’s get to actually writing our assembly program:</p><p>Here is a visual layout of an assembly program:</p><p>‍</p><figure class="w-richtext-align-center w-richtext-figure-type-image"><div><img src="../images/img3.webp" loading="lazy" alt=""/></div></figure><p>‍</p><p>First we need to create a variable ‘msg’ in the .data section of our program and “assign to it the string we need to output,” (asmtutor.com). In our .text section we tell the kernel where to begin execution by “providing it with a global label _start: to denote the programs entry point,” (asmtutor.com).</p><p>We’re using sys_write to write our output to the console window. This function takes three arguments which are “sequentially loaded into EDX, ECX, and EBX before requesting a software interrupt which will perform the task,” (asmtutor.com):</p><ol role="list"><li>EDX will be loaded with the length of the string</li><li>ECX will be loaded with the address of our variable created in the .data section</li><li>EBX will be loaded with the file we want to write to</li></ol><p>In the end our final assembly program will look like:</p><p>‍</p><figure class="w-richtext-align-center w-richtext-figure-type-image"><div><img src="../images/img4-1.webp" loading="lazy" alt=""/></div></figure><p>‍</p><p>And when we compile and link it:</p><p>‍</p><figure class="w-richtext-align-center w-richtext-figure-type-image"><div><img src="../images/img5-1.webp" loading="lazy" alt=""/></div></figure><p>‍</p><p>There are TONS of assembly instructions so asmtutor.com recommends that you at least familiarize yourself with the following common routines:</p><p>‍</p><figure class="w-richtext-align-center w-richtext-figure-type-image"><div><img src="../images/img6-1.webp" loading="lazy" alt=""/></div></figure><p>‍</p><p>The “db” instruction initializes memory with the “Hello World!” string (keil.com). “0Ah” specifies how many bytes in memory that string will need.</p><p>Hopefully the reader has a better sense of the general structure of an assembly program and of the significance and process by which system calls are invoked.</p><p>‍</p><blockquote>Note: After writing one of my first assembly programs and running it with NASM, I was confused as to why we had to compile our assembly code. After all, in C programming, the compilation stage of the compilation process, translates source code into assembly. However, since we’re already in assembly, I wasn’t quite sure what compilation was actually doing. It turns out that “compilation” in the context of NASM means going from assembly instructions to binary (<a href="https://en.wikipedia.org/wiki/Netwide_Assembler#:~:text=Peter%20Anvin%2C%20et%20al.&amp;text=The%20Netwide%20Assembler%20(NASM)%20is,most%20popular%20assemblers%20for%20Linux.">en.wikipedia.org</a>). Once we’re in binary, the program can be linked and run.</blockquote><p>‍</p><p>The reader is probably also wondering why we received a segmentation fault when we ran our program. We will address that very question in our next tutorial.</p><p>‍</p></div></div></div></div><div class="section more-insights"><div class="container"><div class="insights-header-flex no-left-padding"><h2 class="dark-text">Explore more insights</h2></div><div class="insights-list-wrapper w-dyn-list"><div role="list" class="insights-list w-dyn-items"><div role="listitem" class="insight-item more w-dyn-item"><a href="/insights/expanding-our-windbg-arsenal-handleex-extension" class="insight-link-block w-inline-block"><div class="insight-card"><div class="card-left"><img alt="" loading="lazy" width="88" src="../images/01-white-isotype-40png-1.png" class="card-logo-image"/><div class="card-title-text">Expanding Our WinDBG Arsenal - Handleex Extension</div></div><div style="background-image:url(&quot;../images/extensioninaction.png&quot;)" class="card-right"></div></div><h2 class="card-title _30px">Expanding Our WinDBG Arsenal - Handleex Extension</h2><div class="publish-date">May 11, 2023</div></a></div><div role="listitem" class="insight-item more w-dyn-item"><a href="/insights/seh-overflow-with-multi-staged-jumps" class="insight-link-block w-inline-block"><div class="insight-card"><div class="card-left"><img alt="" loading="lazy" width="88" src="../images/01-white-isotype-40png-1.png" class="card-logo-image"/><div class="card-title-text">SEH Overflow with Multi-Staged Jumps</div></div><div style="background-image:url(&quot;../images/img0-1.webp&quot;)" class="card-right"></div></div><h2 class="card-title _30px">SEH Overflow with Multi-Staged Jumps</h2><div class="publish-date">June 26, 2020</div></a></div><div role="listitem" class="insight-item more w-dyn-item"><a href="/insights/think-offensive-leverage-osquery-for-discovery-and-enumeration" class="insight-link-block w-inline-block"><div class="insight-card"><div class="card-left"><img alt="" loading="lazy" width="88" src="" class="card-logo-image w-dyn-bind-empty"/><div class="card-title-text">Think Offensive - Leverage OSQuery for Discovery and Enumeration</div></div><div style="background-image:url(&quot;../images/osquery-1.jpeg&quot;)" class="card-right"></div></div><h2 class="card-title _30px">Think Offensive - Leverage OSQuery for Discovery and Enumeration</h2><div class="publish-date">June 29, 2023</div></a></div><div role="listitem" class="insight-item more w-dyn-item"><a href="/insights/asm-2-tutorial-different-addressing-methods-2" class="insight-link-block w-inline-block"><div class="insight-card"><div class="card-left"><img alt="" loading="lazy" width="88" src="../images/01-white-isotype-40png-1.png" class="card-logo-image"/><div class="card-title-text">ASM 2 Tutorial - Different Addressing Methods</div></div><div style="background-image:url(&quot;../images/pexels-photo-5952647.jpeg&quot;)" class="card-right"></div></div><h2 class="card-title _30px">ASM 2 Tutorial - Different Addressing Methods</h2><div class="publish-date">March 19, 2021</div></a></div></div></div></div></div><div id="Footer" class="section footer"><div class="container"><h2 data-w-id="ae4b8e71-0363-414c-edd7-c73018081b98" class="large-text footer-heading">Security You Can Trust</h2><div class="footer-content-contain"><div class="footer-flex"><div class="footer-left"><p data-w-id="ae4b8e71-0363-414c-edd7-c73018081b9d">As we are passionate about this industry, security and research comes as a second nature for us providing our customers with unmatched results. Let&#x27;s get in touch!</p><div class="footer-contact-links-wrap"><a data-w-id="ae4b8e71-0363-414c-edd7-c73018081ba0" href="#" class="link-block w-inline-block"><div class="link-block-left"><img src="../images/free-mail-icon-142-thumb.png" loading="eager" width="20" alt="" class="contact-icon"/><div class="contact-type">Email</div></div><div class="link-block-center"><div class="contact-symbol">@</div></div><div class="link-block-right"><div class="contact">hello@darkwaves.io</div></div><div class="link-block-border"><div class="link-block-hover-border"></div></div></a><a data-w-id="ae4b8e71-0363-414c-edd7-c73018081bad" href="https://twitter.com/DarkWaves_Sec" target="_blank" class="link-block w-inline-block"><div class="link-block-left"><img src="../images/81609.png" loading="eager" width="20" sizes="20px" alt="" srcset="../images/81609-p-500.png 500w, ../images/81609-1.png 512w" class="contact-icon"/><div class="contact-type">Twitter</div></div><div class="link-block-center"><img src="../images/contact-20arrow.svg" loading="lazy" width="16" alt="" class="contact-arrow"/></div><div class="link-block-right"><div class="contact">@DarkWaves_Sec</div></div><div class="link-block-border"><div class="link-block-hover-border"></div></div></a><a data-w-id="ae4b8e71-0363-414c-edd7-c73018081bb9" href="https://www.linkedin.com/company/dwsec" target="_blank" class="link-block w-inline-block"><div class="link-block-left"><img src="../images/174857.png" loading="eager" width="20" sizes="20px" alt="" srcset="../images/174857-p-500.png 500w, ../images/174857-1.png 512w" class="contact-icon"/><div class="contact-type">LinkedIn</div></div><div class="link-block-center"><img src="../images/contact-20arrow.svg" loading="lazy" width="16" alt="" class="contact-arrow"/></div><div class="link-block-right"><div class="contact">@dwsec</div></div><div class="link-block-border"><div class="link-block-hover-border"></div></div></a></div></div><div class="footer-right"><h3 data-w-id="ae4b8e71-0363-414c-edd7-c73018081bde" class="footer-address">DARK WAVES INFOSEC LTD<br/>71-75 Shelton Street<br/>Covent Garden<br/>London<br/>WC2H 9JQ</h3><div class="_20px-height-gap-div"></div><div data-w-id="ae4b8e71-0363-414c-edd7-c73018081be5" class="copyrights">Copyright © Dark Waves Infosec LTD.<br/></div></div></div></div></div></div><script src="../js/jquery.js" type="text/javascript"  ></script><script src="../js/webflow-script.js" type="text/javascript"></script></body></html>